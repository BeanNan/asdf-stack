#!/usr/bin/env bash
list_tags() {
  local cmd="curl -s"
  if [ -n "$GITHUB_API_TOKEN" ]; then
    cmd="$cmd -H 'Authorization: token $GITHUB_API_TOKEN'"
  fi
  $cmd https://api.github.com/repos/commercialhaskell/stack/tags
}

match_version() {
  grep -o '[0-9]\+\(\.[0-9]\+\)\{2,3\}'
}

to_list() {
  tr '\n' ' '
}

list_tags | grep name | match_version | to_list
