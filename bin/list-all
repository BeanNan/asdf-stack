#!/bin/bash
main() {
  versions=$(get_tags | jq -r .[].name | sed "s/^v//" | sort -V)
  echo $versions
}

get_tags() {
  cmd="curl -s"
  if [ -n "$GITHUB_API_TOKEN" ]; then
    cmd="$cmd -H 'Authorization: token $GITHUB_API_TOKEN'"
  fi
  $cmd "https://api.github.com/repos/commercialhaskell/stack/tags"
}

if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
  main
fi
